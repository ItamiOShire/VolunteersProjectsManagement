<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/main-layout.css">
    <link rel="stylesheet" href="/css/login.css">
    <link rel="stylesheet" href="/css/form-layout.css">
    <title>Strona główna</title>
</head>
<body>

    <header class="header">

        <div class="logo-container">
            <img src="images/logo.png" alt="logo" class="logo">
        </div>

        <nav class="nav-menu">
            <div class="nav-links-container">
                <a href="" class="nav-link">O nas</a>
                <a href="" class="nav-link">Projekty</a>
                <a href="" class="nav-link">Organizacje</a>
                <a href="" class="nav-link">Kontakt</a>
            </div>
            <div class="sign-in-up-buttons">
                <a href="/login" class="nav-link">Logowanie</a>
                <a href="/register" class="nav-link">Rejestracja</a>
            </div>

        </nav>

    </header>

    <div class="text-container">STRONA LOGOWANIA</div>
    <h5 class="desc-short"> Aby się zalogować, podaj dane w formularzu</h5>

    <hr class="section-line">

    <main class="main">

        <div class="form-container">

            <form action="" class="form" name="loginForm">

                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="Podaj email" required><br>
                
                <label for="password">Hasło</label>
                <input type="password" id="password" name="password" placeholder="Podaj hasło" required><br>

                <button type="button" onclick = "logIn()">Zaloguj się</button>

                <a href="" >Nie pamiętasz hasła?</a>

            </form>

        </div>
    </main>

    <hr class="section-line">

    <footer class="footer">
        <div class="footer-col1"><img src="images/logo2mini.png" alt=""></div>
        <div class="footer-col2">col2</div>
        <div class="footer-col3">col3</div>
        <div class="footer-col4">col4</div>

    </footer>

<script>

    async function logIn() {

        const form = document.forms["loginForm"];

        const formData = new FormData(form);

        const data = Object.fromEntries(formData.entries());


        try {
            const response = await fetch("http://localhost:8080/api/login/auth" , {
                method: 'POST',
                headers: {
                    'Content-Type' : 'application/json',
                } ,
                body: JSON.stringify(data),
            });

            if (response.ok) {
                const result = await response.text();
                console.log(result);
                if (result === "VOLUNTEER") {
                    location.href = "http://localhost:8080/volunteer/projects";
                } else {
                    location.href = "http://localhost:8080/organisation/projects"
                }
            } else {
                console.log("Błąd odpowiedzi serwera ", (await response).status);
            }
        } catch (error) {
            console.log(error);
        }

    }

    async function getId(){
        try {
            const response = await fetch("http://localhost:8080/api/login/getId", {
                method: "GET",
                'Content-Type': 'application/json',
            });

            if (response.ok){
                const result = await response.text();
                console.log(result);
            } else {
                console.log("cos nie poszlo");
            }
        } catch (error){
            console.log(error)
        }
    }

</script>
    
</body>
</html>